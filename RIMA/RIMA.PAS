program rima_game; uses crt,graph,dos; label 1,2,3,4,5,6,save,save2,press_c;
type tabel=array[1..2500,1..3] of integer;
var gd,gm,poc,level,x,max,y,q,time,k,p,pp,i,e,xr,yr,aa,cl1,cl2,cl3,cl4,xa,ya,x0,y0,max0,q0,e0,level0:integer;
c,cc:char; t,t0:tabel;w,score,top,w0:longint;ht,mt,st,zt,ht2,mt2,st2,zt2:word;
tr,salt,once,on,zvuc,tii:boolean;
    f1,f2:text; name,sc,high,plus:string;
procedure rima1(x,y:integer);
var i:integer;
begin
setcolor(cl3);
for i:=0 to 6 do rectangle(x-i,y-i+2,x+i,y+i-2); setcolor(cl1);
line(x-6,y-4,x+6,y-4);
line(x-6,y+4,x+6,y+4);
line(x-6,y-3,x-1,y+3);
line(x+1,y+3,x+6,y-3);
end;
procedure rima2(x,y:integer);
var i:integer;
begin
setcolor(cl3);
for i:=0 to 6 do rectangle(x-i+2,y-i,x+i-2,y+i); setcolor(cl1);
line(x-4,y-6,x-4,y+6);
line(x+4,y-6,x+4,y+6);
line(x-3,y-6,x+3,y-1);
line(x-3,y+6,x+3,y+1);
end;
procedure cap_st(x,y:integer);
begin
line(x+6,y-4,x,y-4);
line(x,y-5,x-1,y-5);
line(x+4,y+2,x+3,y+2);
line(x+3,y+3,x,y+3);
line(x-1,y+4,x-2,y+4);
line(x-4,y-1,x-5,y);
line(x-2,y-6,x-2,y-6);
setcolor(white);
rectangle(x-3,y-4,x-1,y-2);putpixel(x-2,y-3,WHITE);putpixel(x-3,y-3,1);
setcolor(cl1);
line(x-5,y+1,x-3,y+1);
line(x-2,y,x,y);
line(x+1,y-1,x+3,y-1);
line(x+3,y,x,y+3);
line(x+6,y+4,x+4,y+2);
setcolor(cl3);
line(x-4,y,x-3,y);
line(x-3,y-1,x,y-1);
rectangle(x,y-3,x+6,y-2);
rectangle(x+4,y-1,x+6,y+1);
putpixel(x+5,y,cl3);
line(x+2,y+2,x+3,y+1);
line(x+5,y+2,x+6,y+2);
putpixel(x+6,y+3,cl3);
setcolor(cl1);
end;
procedure cap_dr(x,y:integer);
begin
line(x-6,y-4,x,y-4);
line(x,y-5,x+1,y-5);
line(x-4,y+2,x-3,y+2);
line(x-3,y+3,x,y+3);
line(x+1,y+4,x+2,y+4);
line(x+4,y-1,x+5,y);
line(x+2,y-6,x+2,y-6);
setcolor(white);
rectangle(x+3,y-4,x+1,y-2);putpixel(x+2,y-3,WHITE);putpixel(x+3,y-3,1);
setcolor(cl1);
line(x+5,y+1,x+3,y+1);
line(x+2,y,x,y);
line(x-1,y-1,x-3,y-1);
line(x-3,y,x,y+3);
line(x-6,y+4,x-4,y+2);
setcolor(cl3);
line(x+4,y,x+3,y);
line(x+3,y-1,x,y-1);
rectangle(x,y-3,x-6,y-2);
rectangle(x-4,y-1,x-6,y+1);
putpixel(x-5,y,cl3);
line(x-2,y+2,x-3,y+1);
line(x-5,y+2,x-6,y+2);
putpixel(x-6,y+3,cl3);
setcolor(cl1);
end;
procedure cap_sus(x,y:integer);
begin
line(x+4,y+6,x+4,y);
line(x+5,y,x+5,y-1);
line(x+6,y-2,x+6,y-2);
setcolor(white);
rectangle(x+2,y-3,x+4,y-1); putpixel(x+3,y-2,white); putpixel(x+3,y-3,1);
setcolor(cl1);
line(x+1,y-4,x,y-5);
line(x-1,y-5,x-1,y-3);
line(x,y-2,x,y);
line(x+1,y+1,x+1,y+3);
line(x,y+3,x-2,y+1);
line(x-4,y-2,x-4,y-1);
line(x-3,y,x-3,y+3);
line(x-4,y+6,x-2,y+4);
putpixel(x-2,y+3,1);
setcolor(cl3);
line(x,y-4,x,y-3);
line(x+1,y-3,x+1,y);
rectangle(x+2,y,x+3,y+6);
rectangle(x-1,y+4,x+1,y+6);
putpixel(x,y+5,cl3);
line(x-2,y+2,x-1,y+3);
line(x-2,y+5,x-2,y+6);
putpixel(x-3,y+6,cl3);
setcolor(cl1);
end;
procedure cap_jos(x,y:integer);
begin
line(x+4,y-6,x+4,y);
line(x+5,y,x+5,y+1);
line(x+6,y+2,x+6,y+2);
setcolor(white);
rectangle(x+2,y+3,x+4,y+1); putpixel(x+3,y+2,white); putpixel(x+3,y+3,1);
setcolor(cl1);
line(x+1,y+4,x,y+5);
line(x-1,y+5,x-1,y+3);
line(x,y+2,x,y);
line(x+1,y-1,x+1,y-3);
line(x,y-3,x-2,y-1);
line(x-4,y+2,x-4,y+1);
line(x-3,y,x-3,y-3);
line(x-4,y-6,x-2,y-4);
putpixel(x-2,y-3,1);
setcolor(cl3);
line(x,y+4,x,y+3);
line(x+1,y+3,x+1,y);
rectangle(x+2,y,x+3,y-6);
rectangle(x-1,y-4,x+1,y-6);
putpixel(x,y-5,cl3);
line(x-2,y-2,x-1,y-3);
line(x-2,y-5,x-2,y-6);
putpixel(x-3,y-6,cl3);
setcolor(cl1);
end;
procedure coada_dr(x,y:integer);
begin
line(x+6,y-4,x+5,y-4);
line(x+4,y-4,x-2,y+2);
line(x-6,y+3,x-1,y+3);
line(x-1,y+4,x+6,y+4);
setcolor(cl3);
rectangle(x+4,y-3,x+6,y+3);
line(x+5,y-2,x+5,y+2);
rectangle(x,y+1,x+3,y+3);
line(x+1,y+2,x+2,y+2);
rectangle(x+2,y-1,x+3,y);
putpixel(x+3,y-2,cl3);
putpixel(x+1,y,cl3);
putpixel(x-1,y+2,cl3);
setcolor(cl1);
end;
procedure coada_st(x,y:integer);
begin
line(x-6,y-4,x-5,y-4);
line(x-4,y-4,x+2,y+2);
line(x+6,y+3,x+1,y+3);
line(x+1,y+4,x-6,y+4);
setcolor(cl3);
rectangle(x-4,y-3,x-6,y+3);
line(x-5,y-2,x-5,y+2);
rectangle(x,y+1,x-3,y+3);
line(x-1,y+2,x-2,y+2);
rectangle(x-2,y-1,x-3,y);
putpixel(x-3,y-2,cl3);
putpixel(x-1,y,cl3);
putpixel(x+1,y+2,cl3);
setcolor(cl1);
end;
procedure coada_sus(x,y:integer);
begin
line(x-4,y-6,x-4,y+1);
line(x-3,y+1,x-3,y+6);
line(x-2,y+2,x+4,y-4);
line(x+4,y-6,x+4,y-5);
setcolor(cl3);
rectangle(x-3,y-6,x+3,y-4);
line(x-2,y-5,x+2,y-5);
rectangle(x-3,y-3,x-1,y);
line(x-2,y-2,x-2,y-1);
rectangle(x,y-3,x+1,y-2);
putpixel(x+2,y-3,cl3);
putpixel(x,y-1,cl3);
putpixel(x-2,y+1,cl3);
setcolor(cl1);
end;
procedure coada_jos(x,y:integer);
begin
line(x-4,y+6,x-4,y-1);
line(x-3,y-1,x-3,y-6);
line(x-2,y-2,x+4,y+4);
line(x+4,y+6,x+4,y+5);
setcolor(cl3);
rectangle(x-3,y+6,x+3,y+4);
line(x-2,y+5,x+2,y+5);
rectangle(x-3,y+3,x-1,y);
line(x-2,y+2,x-2,y+1);
rectangle(x,y+3,x+1,y+2);
putpixel(x+2,y+3,cl3);
putpixel(x,y+1,cl3);
putpixel(x-2,y-1,cl3);
setcolor(cl1);
end;
procedure explode(xa,ya:integer);
var i:integer;
begin
for i:=1 to 6 do begin case i mod 3 of
0:setcolor(red);
1:setcolor(6);
2:setcolor(yellow);end;
circle(xa,ya,i);
end;
setcolor(cl1);
end;
procedure ardere(xa,ya,i:integer);
begin
ya:=ya+i-1;
putpixel(xa-1,ya-1,cl2);
putpixel(xa-1,ya+1,cl2);
putpixel(xa+1,ya-1,cl2);
putpixel(xa+1,ya+1,cl2);
putpixel(xa,ya,cl2);
ya:=ya+i+1;
putpixel(xa-1,ya-1,yellow);
putpixel(xa-1,ya+1,yellow);
putpixel(xa+1,ya-1,yellow);
putpixel(xa+1,ya+1,yellow);
putpixel(xa,ya,6);
end;
procedure mar_aur(xa,ya:integer);
var i:integer;
begin
setcolor(6);
for i:=1 to 4 do circle(xa+2,ya-1,i); rectangle(xa+1,ya-2,xa+3,ya); putpixel(xa+2,ya-1,6);
setcolor(cl2); line(xa,ya-5,xa+4,ya-5); line(xa-1,ya-2,xa,ya-3);setcolor(cl1);
line(xa+2,ya-6,xa+2,ya-3);
line(xa+3,ya-3,xa+6,ya-6);
line(xa+4,ya-5,xa+5,ya-6);
line(xa+5,ya-4,xa+6,ya-5);
line(xa-4,ya-4,xa-4,ya+5);
line(xa-3,ya+5,xa-3,ya+5);
setcolor(red); rectangle(xa-2,ya+4,xa+6,ya+6); line(xa-1,ya+5,xa+5,ya+5);
setcolor(cl1);
end;
begin
assign(f2,'time.in');
reset(f2);
readln(f2,poc);
tii:=true;
1:clrscr;
randomize;
textcolor(3+WHITE);
writeln('                          WELLCOME LA RIMA LUI 9370 !');
writeln('');TEXTCOLOR(11);
writeln('                               "Esc" - for EXIT;');
WRITELN('                                "P" -- for PAUSE');
writeln('                              "T"-to change delay');
writeln('');
c:=readkey;
if (c='t')or(c='T') then begin
if not tii then reset(f2);
writeln('Precedentul Delay a fost ',poc);
rewrite(f2);
writeln('Introdu noul Delay:');
readln(poc);
writeln(f2,poc);
writeln('Delay a fost salvat cu succes!');
close(f2);
tii:=false;
end;
writeln('DO YOU WOUNT TO "TURN ON" SOUND ?');
c:=readkey;
if (ord(c)=13)or(c='y')or(c='Y') then zvuc:=true else zvuc:=false;
assign(f1,'top.in');
reset(f1);
READLN(f1,top);
for i:=1 to max do for xr:=1 to 3 do t[i,xr]:=0;
salt:=false;
readln(f1,name);
readln(f1,plus);
if plus='saved' then begin
readln(f1,w,q,max,e,level,x,y);
w0:=w ;q0:=q;max0:=max;e0:=e;level0:=level;x0:=x;y0:=y;aa:=w;
textcolor(10);
writeln('DO YOU WOUNT TO <LOAD> EXIST SAVED GAME WITH {score=',W,'} ?');
c:=readkey;
if (ord(c)=13)or(c='y')or(c='Y') then salt:=true;
if salt then begin
for i:=1 to max do
for xr:=1 to 3 do
begin read(f1,t[i,xr]); t0[i,xr]:=t[i,xr];end;
goto save;end;end;

textcolor(11);
writeln('               Alegeti nivelul de complexitate, de la "1" la "5"');
readln(level); if (level<1)or(level>5) then begin
             textcolor(red);writeln('DE LA "1" LA "5" AM SPUS!');
                           goto 1; end;
save:
case level of 1:time:=10; 2:time:=8; 3:time:=6; 4:time:=4; 5:time:=2; end;
gettime(ht,mt,st,zt);
if salt then goto save2;
for i:=1 to 3000 do for x:=1 to 3 do t[i,x]:=0;
k:=0;p:=0;pp:=0;i:=0;e:=0;xr:=0;yr:=0;w:=0;score:=0;cl1:=0;cl2:=0;cl3:=0;cl4:=0;xa:=0;ya:=0;
x:=92; y:=131; cl1:=1; cl2:=2; cl3:=9;cl4:=4; c:=char(75); cc:=char(77); w:=0; aa:=0;
for i:=1 to 7 do begin t[i,1]:=i*13+1;t[i,2]:=131; t[i,3]:=77;end;
q:=7;e:=1;max:=7;
save2:k:=0;p:=0;pp:=0;i:=0;xr:=t[q,1];yr:=t[q,2];xr:=0;yr:=0;score:=0;cl1:=1; cl2:=2; cl3:=9;cl4:=4;
initgraph(gd,gm,'bgi');
setcolor(cl4);setbkcolor(cl2);
for i:=1 to 7 do rectangle(i,i,639-i,483-i);setcolor(cl1);
settextstyle(smallfont,horizdir,4); setcolor(15);
str(top,high);high:='top score: '+high; outtextxy(530,-3,high);
setcolor(cl1);
if salt then begin setcolor(blue);for i:=1 to max do begin
case t[i,3] of
72:begin rima2(t[i,1],t[i,2]);
case t[i+1,3] of
77:if t[i+1,1]<>14 then begin setcolor(cl2);
line(t[i+1,1]-9,t[i+1,2]-5,t[i+1,1]-17,t[i+1,2]-5);
line(t[i+1,1]-17,t[i+1,2]-6,t[i+1,1]-9,t[i+1,2]-6);
setcolor(cl1);
line(t[i+1,1]-17,t[i+1,2]-4,t[i+1,1]-7,t[i+1,2]-4);
line(t[i+1,1]-8,t[i+1,2]+4,t[i+1,1]-7,t[i+1,2]+4);
setcolor(cl3);
rectangle(t[i+1,1]-9,t[i+1,2]-3,t[i+1,1]-7,t[i+1,2]+3);
line(t[i+1,1]-8,t[i+1,2]-2,t[i+1,1]-8,t[i+1,2]+2);
setcolor(cl1);end;
75:if t[i+1,1]<>625 then begin setcolor(cl2);
line(t[i+1,1]+9,t[i+1,2]-5,t[i+1,1]+17,t[i+1,2]-5);
line(t[i+1,1]+17,t[i+1,2]-6,t[i+1,1]+9,t[i+1,2]-6);
setcolor(cl1);
line(t[i+1,1]+17,t[i+1,2]-4,t[i+1,1]+7,t[i+1,2]-4);
line(t[i+1,1]+8,t[i+1,2]+4,t[i+1,1]+7,t[i+1,2]+4);
setcolor(cl3);
rectangle(t[i+1,1]+9,t[i+1,2]-3,t[i+1,1]+7,t[i+1,2]+3);
line(t[i+1,1]+8,t[i+1,2]-2,t[i+1,1]+8,t[i+1,2]+2);
setcolor(cl1);end;
end;
end;

80:begin rima2(t[i,1],t[i,2]);
case t[i+1,3] of
77:if t[i+1,1]<>14 then begin setcolor(cl2);
line(t[i+1,1]-9,t[i+1,2]+5,t[i+1,1]-17,t[i+1,2]+5);
line(t[i+1,1]-17,t[i+1,2]+6,t[i+1,1]-9,t[i+1,2]+6);
setcolor(cl1);
line(t[i+1,1]-17,t[i+1,2]+4,t[i+1,1]-7,t[i+1,2]+4);
line(t[i+1,1]-8,t[i+1,2]-4,t[i+1,1]-7,t[i+1,2]-4);
setcolor(cl3);
rectangle(t[i+1,1]-9,t[i+1,2]+3,t[i+1,1]-7,t[i+1,2]-3);
line(t[i+1,1]-8,t[i+1,2]+2,t[i+1,1]-8,t[i+1,2]-2);
setcolor(cl1);end;
75:if t[i+1,1]<>625 then begin setcolor(cl2);
line(t[i+1,1]+9,t[i+1,2]+5,t[i+1,1]+17,t[i+1,2]+5);
line(t[i+1,1]+17,t[i+1,2]+6,t[i+1,1]+9,t[i+1,2]+6);
setcolor(cl1);
line(t[i+1,1]+17,t[i+1,2]+4,t[i+1,1]+7,t[i+1,2]+4);
line(t[i+1,1]+8,t[i+1,2]-4,t[i+1,1]+7,t[i+1,2]-4);
setcolor(cl3);
rectangle(t[i+1,1]+9,t[i+1,2]+3,t[i+1,1]+7,t[i+1,2]-3);
line(t[i+1,1]+8,t[i+1,2]+2,t[i+1,1]+8,t[i+1,2]-2);
setcolor(cl1);end;
end;
end;
77:begin rima1(t[i,1],t[i,2]);
case t[i+1,3] of
72:if t[i+1,2]<>469 then begin setcolor(cl2);
line(t[i+1,1]+6,t[i+1,2]+9,t[i+1,1]+6,t[i+1,2]+17);
line(t[i+1,1]+5,t[i+1,2]+9,t[i+1,1]+5,t[i+1,2]+17);
setcolor(cl1);
line(t[i+1,1]-4,t[i+1,2]+7,t[i+1,1]-4,t[i+1,2]+8);
line(t[i+1,1]+4,t[i+1,2]+7,t[i+1,1]+4,t[i+1,2]+16);
setcolor(cl3);
rectangle(t[i+1,1]-3,t[i+1,2]+7,t[i+1,1]+3,t[i+1,2]+9);
line(t[i+1,1]-2,t[i+1,2]+8,t[i+1,1]+2,t[i+1,2]+8);
setcolor(cl1);end;
80:if t[i+1,2]<>14 then begin setcolor(cl2);
line(t[i+1,1]+6,t[i+1,2]-9,t[i+1,1]+6,t[i+1,2]-17);
line(t[i+1,1]+5,t[i+1,2]-9,t[i+1,1]+5,t[i+1,2]-17);
setcolor(cl1);
line(t[i+1,1]-4,t[i+1,2]-7,t[i+1,1]-4,t[i+1,2]-8);
line(t[i+1,1]+4,t[i+1,2]-7,t[i+1,1]+4,t[i+1,2]-16);
setcolor(cl3);
rectangle(t[i+1,1]-3,t[i+1,2]-7,t[i+1,1]+3,t[i+1,2]-9);
line(t[i+1,1]-2,t[i+1,2]-8,t[i+1,1]+2,t[i+1,2]-8);
setcolor(cl1);end;
end;
end;
75:begin rima1(t[i,1],t[i,2]);
case t[i+1,3] of
72:if t[i+1,2]<>469 then begin setcolor(cl2);
line(t[i+1,1]-6,t[i+1,2]+9,t[i+1,1]-6,t[i+1,2]+17);
line(t[i+1,1]-5,t[i+1,2]+9,t[i+1,1]-5,t[i+1,2]+17);
setcolor(cl1);
line(t[i+1,1]+4,t[i+1,2]+7,t[i+1,1]+4,t[i+1,2]+8);
line(t[i+1,1]-4,t[i+1,2]+7,t[i+1,1]-4,t[i+1,2]+16);
setcolor(cl3);
rectangle(t[i+1,1]+3,t[i+1,2]+7,t[i+1,1]-3,t[i+1,2]+9);
line(t[i+1,1]+2,t[i+1,2]+8,t[i+1,1]-2,t[i+1,2]+8);
setcolor(cl1);end;
80:if t[i+1,2]<>14 then begin setcolor(cl2);
line(t[i+1,1]-6,t[i+1,2]-9,t[i+1,1]-6,t[i+1,2]-17);
line(t[i+1,1]-5,t[i+1,2]-9,t[i+1,1]-5,t[i+1,2]-17);
setcolor(cl1);
line(t[i+1,1]+4,t[i+1,2]-7,t[i+1,1]+4,t[i+1,2]-8);
line(t[i+1,1]-4,t[i+1,2]-7,t[i+1,1]-4,t[i+1,2]-16);
setcolor(cl3);
rectangle(t[i+1,1]+3,t[i+1,2]-7,t[i+1,1]-3,t[i+1,2]-9);
line(t[i+1,1]+2,t[i+1,2]-8,t[i+1,1]-2,t[i+1,2]-8);
setcolor(cl1);end;
end;
end;
end;
end;
setcolor(cl2);
for i:=1 to 6 do rectangle(t[q,1]-i,t[q,2]-i,t[q,1]+i,t[q,2]+i);
setcolor(cl1);
case t[q,3] of
72:cap_sus(t[q,1],t[q,2]);
77:cap_dr(t[q,1],t[q,2]);
75:cap_st(t[q,1],t[q,2]);
80:cap_jos(t[q,1],t[q,2]);end;
c:=readkey;
end;
xr:=t[q,1];yr:=t[q,2]; once:=true;
repeat
if (t[q,1]=xr)and(t[q,2]=yr) then begin
if zvuc then sound(2900);
5:xr:=(random(48)+1)*13+1;
yr:=(random(36)+1)*13+1;
for i:=1 to max do if (xr=t[i,1])and(yr=t[i,2]) then goto 5;
setcolor(red);
for i:=0 to 5 do circle(xr,yr+1,i);tr:=false;max:=max+1;
rectangle(xr-1,yr-1,xr+1,yr+2);putpixel(xr,yr+1,red);
putpixel(xr-4,yr+3,red); putpixel(xr+2,yr+5,red); putpixel(xr+4,yr+3,red);
setcolor(blue);line(xr,yr-3,xr,yr-6);
line(xr+1,yr-3,xr+2,yr-5);
line(xr+2,yr-5,xr+6,yr-6);
line(xr+6,yr-6,xr+3,yr-3);
line(xr+3,yr-3,xr+1,yr-3);
line(xr+2,yr-4,xr+3,yr-4);
setcolor(red);
outtextxy(9,-3,sc);
setcolor(15);
w:=(max+score-8)*9;
case level of
2:w:=w+(w*3 div 10);
3:w:=w+(w*4 div 10);
4:w:=w+(w*5 div 10);
5:w:=w+(w*7 div 10);
end;
if once and salt then aa:=aa-w;
once:=false;
str(w+aa,sc);
sc:='score: '+sc;
settextstyle(smallfont,horizdir,4);
outtextxy(9,-3,sc);
setcolor(cl1);
end;
if (x=xa)and(y=ya) then begin
if zvuc then sound(4400);
pp:=0;score:=score-(p div 3);p:=0;xa:=1;ya:=1;
setcolor(red);
outtextxy(9,-3,sc);
setcolor(15);
w:=(max+score-8)*9;
case level of
2:w:=w+(w*3 div 10);
3:w:=w+(w*4 div 10);
4:w:=w+(w*5 div 10);
5:w:=w+(w*7 div 10);
end;
str(w+aa,sc);
sc:='score: '+sc;
settextstyle(smallfont,horizdir,4);
outtextxy(9,-3,sc);
setcolor(cl1);
end;
pp:=pp+1;
if pp>5 then begin 6:xa:=(random(48)+1)*13+1;
ya:=(random(36)+1)*13+1;
for i:=1 to max do if ((xa=t[i,1])and(ya=t[i,2]))or((xa=xr)and(ya=yr)) then goto 6;
mar_aur(xa,ya);pp:=0; p:=-61;
end;
repeat
if p>0 then begin p:=p-1;if p=0 then begin setcolor(cl2);for i:=1 to 6 do rectangle(xa-i,ya-i,xa+i,ya+i);setcolor(cl1);
putpixel(xa,ya,cl2);xa:=1;ya:=1;end; end;
if p<0 then begin p:=p+1;ardere(xa-4,ya+1,(p div 6)div 3);end;
if p=-1 then begin explode(xa,ya);p:=2;end;
if (max>1726)and(t[1726,1]<>0) then begin
name:='FELICITARI ! ESTI CISTIGATOR ABSOLUT AL GM_RIMA DE 9370 !';
settextstyle(triplexfont,horizdir,2);
i:=0;
repeat
i:=i+1;
if odd(i) then setcolor(yellow) else setcolor(12);
outtextxy(10,140,name);delay(poc);
until i>50;
readln;
goto 3;end;
press_c:if keypressed then c:=readkey else begin c:=cc;goto 2;end;
case ord(c) of 0:begin c:=readkey;
if on then begin
2:q:=q+1;if q>max then q:=1; if q-1<1 then w:=max else w:=q-1;
setcolor(cl2);for i:=0 to 6 do rectangle(t[e,1]-i,t[e,2]-i,t[e,1]+i,t[e,2]+i);setcolor(1);
if q+1>max then e:=1 else e:=q+1;
if (ord(c)=72)or(ord(c)=75)or(ord(c)=77)or(ord(c)=80)or(ord(c)=112)then else c:=cc;
end;
case ord(c) of
72:if ord(cc)=80 then c:=char(cc);
80:if ord(cc)=72 then c:=char(cc);
77:if ord(cc)=75 then c:=char(cc);
75:if ord(cc)=77 then c:=char(cc);
end;
case ord(c) of
    {sus}72: begin
    if on then begin
    if y-13<14 then k:=469 else k:=y-13;
    for i:=1 to max do if (t[i,1]=x)and(t[i,2]=k) then begin delay(poc);on:=false;cc:=c;goto press_c;end;end;
    t[q,1]:=x; y:=y-13; if y<7 then y:=469; t[q,2]:=y; t[q,3]:=72;
    for i:=1 to max do if (x=t[i,1])and(y=t[i,2])and(i<>q)and(i<>e) then goto 3;
    setcolor(cl2);for i:=0 to 6 do rectangle(t[w,1]-i,t[w,2]-i,t[w,1]+i,t[w,2]+i);
    setcolor(cl1); if (x=xr)and(y=yr) then tr:=true;on:=true;
    cap_sus(x,y);
    goto 4;end;

    {jos}80:  begin
    if on then begin
    if y+13>469 then k:=14 else k:=y+13;
    for i:=1 to max do if (t[i,1]=x)and(t[i,2]=k) then begin delay(poc);on:=false;cc:=c;goto press_c;end;end;
    t[q,1]:=x; y:=y+13;if y>469 then y:=14; t[q,2]:=y; t[q,3]:=80;
    for i:=1 to max do if (x=t[i,1])and(y=t[i,2])and(i<>q)and(i<>e) then goto 3;
    setcolor(cl2);for i:=0 to 6 do rectangle(t[w,1]-i,t[w,2]-i,t[w,1]+i,t[w,2]+i);setcolor(cl1);
    cap_jos(x,y);if (x=xr)and(y=yr) then tr:=true;on:=true;
    goto 4;end;

{dreapta}77:  begin
    if on then begin
    if x+13>625 then k:=14 else k:=x+13;
    for i:=1 to max do if (t[i,1]=k)and(t[i,2]=y) then begin delay(poc);on:=false;cc:=c;goto press_c;end;end;
    t[q,2]:=y; x:=x+13; if x>625 then x:=14;t[q,1]:=x;t[q,3]:=77;
    for i:=1 to max do if (x=t[i,1])and(y=t[i,2])and(i<>q)and(i<>e) then goto 3;
    setcolor(cl2);for i:=0 to 6 do rectangle(t[w,1]-i,t[w,2]-i,t[w,1]+i,t[w,2]+i);setcolor(cl1);
    cap_dr(x,y); if (x=xr)and(y=yr) then tr:=true;on:=true;
    goto 4;end;

 {stinga}75: begin
    if on then begin
    if x-13<14 then k:=625 else k:=x-13;
    for i:=1 to max do if (t[i,1]=k)and(t[i,2]=y) then begin delay(poc);on:=false;cc:=c;goto press_c;end;end;
    t[q,2]:=y; x:=x-13; if x<14 then x:=625; t[q,1]:=x;t[q,3]:=75;
    for i:=1 to max do if (x=t[i,1])and(y=t[i,2])and(i<>q)and(i<>e) then goto 3;
    setcolor(cl2);for i:=0 to 6 do rectangle(t[w,1]-i,t[w,2]-i,t[w,1]+i,t[w,2]+i);setcolor(cl1);
    cap_st(x,y); if (x=xr)and(y=yr) then tr:=true;on:=true;
    goto 4;end;

end;end;end;
4:setcolor(cl2);
for i:=0 to 6 do rectangle(t[e,1]-i,t[e,2]-i,t[e,1]+i,t[e,2]+i);setcolor(cl1);
case t[e,3] of
72:coada_sus(t[e,1],t[e,2]);
80:coada_jos(t[e,1],t[e,2]);
77:coada_dr(t[e,1],t[e,2]);
75:coada_st(t[e,1],t[e,2]);
end;
k:=q;
if q-1<1 then k:=max else k:=k-1;

case t[k,3] of
72:begin rima2(t[k,1],t[k,2]);
case t[q,3] of
77:if t[q,1]<>14 then begin setcolor(cl2);
line(t[q,1]-9,t[q,2]-5,t[q,1]-17,t[q,2]-5);
line(t[q,1]-17,t[q,2]-6,t[q,1]-9,t[q,2]-6);
setcolor(cl1);
line(t[q,1]-17,t[q,2]-4,t[q,1]-7,t[q,2]-4);
line(t[q,1]-8,t[q,2]+4,t[q,1]-7,t[q,2]+4);
setcolor(cl3);
rectangle(t[q,1]-9,t[q,2]-3,t[q,1]-7,t[q,2]+3);
line(t[q,1]-8,t[q,2]-2,t[q,1]-8,t[q,2]+2);
setcolor(cl1);end;
75:if t[q,1]<>625 then begin setcolor(cl2);
line(t[q,1]+9,t[q,2]-5,t[q,1]+17,t[q,2]-5);
line(t[q,1]+17,t[q,2]-6,t[q,1]+9,t[q,2]-6);
setcolor(cl1);
line(t[q,1]+17,t[q,2]-4,t[q,1]+7,t[q,2]-4);
line(t[q,1]+8,t[q,2]+4,t[q,1]+7,t[q,2]+4);
setcolor(cl3);
rectangle(t[q,1]+9,t[q,2]-3,t[q,1]+7,t[q,2]+3);
line(t[q,1]+8,t[q,2]-2,t[q,1]+8,t[q,2]+2);
setcolor(cl1);end;
end;
end;

80:begin rima2(t[k,1],t[k,2]);
case t[q,3] of
77:if t[q,1]<>14 then begin setcolor(cl2);
line(t[q,1]-9,t[q,2]+5,t[q,1]-17,t[q,2]+5);
line(t[q,1]-17,t[q,2]+6,t[q,1]-9,t[q,2]+6);
setcolor(cl1);
line(t[q,1]-17,t[q,2]+4,t[q,1]-7,t[q,2]+4);
line(t[q,1]-8,t[q,2]-4,t[q,1]-7,t[q,2]-4);
setcolor(cl3);
rectangle(t[q,1]-9,t[q,2]+3,t[q,1]-7,t[q,2]-3);
line(t[q,1]-8,t[q,2]+2,t[q,1]-8,t[q,2]-2);
setcolor(cl1);end;
75:if t[q,1]<>625 then begin setcolor(cl2);
line(t[q,1]+9,t[q,2]+5,t[q,1]+17,t[q,2]+5);
line(t[q,1]+17,t[q,2]+6,t[q,1]+9,t[q,2]+6);
setcolor(cl1);
line(t[q,1]+17,t[q,2]+4,t[q,1]+7,t[q,2]+4);
line(t[q,1]+8,t[q,2]-4,t[q,1]+7,t[q,2]-4);
setcolor(cl3);
rectangle(t[q,1]+9,t[q,2]+3,t[q,1]+7,t[q,2]-3);
line(t[q,1]+8,t[q,2]+2,t[q,1]+8,t[q,2]-2);
setcolor(cl1);end;
end;
end;
77:begin rima1(t[k,1],t[k,2]);
case t[q,3] of
72:if t[q,2]<>469 then begin setcolor(cl2);
line(t[q,1]+6,t[q,2]+9,t[q,1]+6,t[q,2]+17);
line(t[q,1]+5,t[q,2]+9,t[q,1]+5,t[q,2]+17);
setcolor(cl1);
line(t[q,1]-4,t[q,2]+7,t[q,1]-4,t[q,2]+8);
line(t[q,1]+4,t[q,2]+7,t[q,1]+4,t[q,2]+16);
setcolor(cl3);
rectangle(t[q,1]-3,t[q,2]+7,t[q,1]+3,t[q,2]+9);
line(t[q,1]-2,t[q,2]+8,t[q,1]+2,t[q,2]+8);
setcolor(cl1);end;
80:if t[q,2]<>14 then begin setcolor(cl2);
line(t[q,1]+6,t[q,2]-9,t[q,1]+6,t[q,2]-17);
line(t[q,1]+5,t[q,2]-9,t[q,1]+5,t[q,2]-17);
setcolor(cl1);
line(t[q,1]-4,t[q,2]-7,t[q,1]-4,t[q,2]-8);
line(t[q,1]+4,t[q,2]-7,t[q,1]+4,t[q,2]-16);
setcolor(cl3);
rectangle(t[q,1]-3,t[q,2]-7,t[q,1]+3,t[q,2]-9);
line(t[q,1]-2,t[q,2]-8,t[q,1]+2,t[q,2]-8);
setcolor(cl1);end;
end;
end;
75:begin rima1(t[k,1],t[k,2]);
case t[q,3] of
72:if t[q,2]<>469 then begin setcolor(cl2);
line(t[q,1]-6,t[q,2]+9,t[q,1]-6,t[q,2]+17);
line(t[q,1]-5,t[q,2]+9,t[q,1]-5,t[q,2]+17);
setcolor(cl1);
line(t[q,1]+4,t[q,2]+7,t[q,1]+4,t[q,2]+8);
line(t[q,1]-4,t[q,2]+7,t[q,1]-4,t[q,2]+16);
setcolor(cl3);
rectangle(t[q,1]+3,t[q,2]+7,t[q,1]-3,t[q,2]+9);
line(t[q,1]+2,t[q,2]+8,t[q,1]-2,t[q,2]+8);
setcolor(cl1);end;
80:if t[q,2]<>14 then begin setcolor(cl2);
line(t[q,1]-6,t[q,2]-9,t[q,1]-6,t[q,2]-17);
line(t[q,1]-5,t[q,2]-9,t[q,1]-5,t[q,2]-17);
setcolor(cl1);
line(t[q,1]+4,t[q,2]-7,t[q,1]+4,t[q,2]-8);
line(t[q,1]-4,t[q,2]-7,t[q,1]-4,t[q,2]-16);
setcolor(cl3);
rectangle(t[q,1]+3,t[q,2]-7,t[q,1]-3,t[q,2]-9);
line(t[q,1]+2,t[q,2]-8,t[q,1]-2,t[q,2]-8);
setcolor(cl1);end;
end;
end;
end;
if ord(c)=112 then repeat until keypressed;
cc:=char(t[q,3]);
for k:=1 to time do delay(poc div 2);
nosound;
for k:=1 to time do delay(poc div 2);
until (ord(c)=27)or((x=xa)and(y=ya))or tr;
until ord(c)=27;
3:cleardevice;
closegraph;
FOR I:=1 TO 2 DO begin if zvuc then sound(2000*i);for k:=1 to 10 do DELAY(poc);end;
w:=(max+score-8)*9;
case level of
2:w:=w+(w*3 div 10);
3:w:=w+(w*4 div 10);
4:w:=w+(w*5 div 10);
5:w:=w+(w*7 div 10);
end;
nosound;
gettime(ht2,mt2,st2,zt2);
if ht>ht2 then ht:=ht2+24-ht else ht:=ht2-ht;
if mt>mt2 then mt:=mt2+60-mt else mt:=mt2-mt;
if st>st2 then st:=st2+60-st else st:=st2-st;
if zt>zt2 then zt:=zt2+100-zt else zt:=zt2-zt;
if salt then w:=w+aa;
TEXTCOLOR(RED+WHITE+3);
writeln('                                GAME OVER BABY!');
WRITELN(' ');
TEXTCOLOR(11);
WRITE('                     TU CU RIMA TA ATI ACUMULAT "');TEXTCOLOR(YELLOW);WRITE(W);TEXTCOLOR(11);WRITE('" BILE!');
WRITELN('');
WRITELN('                                   MALADETZ!');
WRITELN(' ');
textcolor(2);
writeln('                                   Time Game :');
writeln('                         ',ht,'_h  ',mt,'_min  ',st,'_sec  ',zt,'_milisec');
WRITELN(' ');WRITELN(' ');WRITELN(' ');WRITELN(' ');
textcolor(11);
WRITELN('                                  press "enter"');readln;
writeln('                                  TOP SCORE IS:');TEXTCOLOR(YELLOW);
if (top<w)or(top=w) then begin top:=w; rewrite(f1);writeln(f1,top);
writeln('                                      ',top);textcolor(white);
writeln('                                 AND IT IS YOUR!');TEXTCOLOR(YELLOW+1+white);
writeln('               CONGRADULATIONS! YOU ARE THE BEST! YOU ARE A WINERR!');
textcolor(11);
writeln('                              TYPE YOUR NAME HERE!: ');READLN(NAME);WRITELN(F1,NAME);
if salt then begin writeln(f1,plus);writeln(f1,w0,' ',q0,' ',max0,' ',e0,' ',level0,' ',x0,' ',y0);for i:=1 to max0 do begin
writeln(f1);for xr:=1 to 3 do write(f1,t0[i,xr],' ');end;end;END;
if top>w then begin writeln('                                      ',top);textcolor(white);
writeln('                               BUT IT IS NOT YOUR.');
WRITE('                          IT IS: ');TEXTCOLOR(YELLOW);WRITE(NAME);WRITELN('');END;
if (ord(c)=27) then begin
textcolor(12);
writeln('DO YOU WOUNT TO <OVERWRITE> THE EXIST SAVED GAME {score=',w0,'}');
write('                                 AND <SAVE> THIS {');
if w<w0 then begin textcolor(10+1+white);write('score=',w);
textcolor(12);write('} ?');end;
if w>=w0 then write('score=',w,'} ?');
c:=readkey;
if (ord(c)=13)or(c='y')or(c='Y') then begin
rewrite(f1);writeln(f1,top);writeln(f1,name);plus:='saved';writeln(f1,plus);
writeln(f1,w,' ',q,' ',max,' ',e,' ',level,' ',x,' ',y);
for i:=1 to max do begin writeln(f1);for xr:=1 to 3 do write(f1,t[i,xr],' ');end;end;end;
textcolor(red);
WRITELN(' ');
WRITE('         DACA DORESTI SA LASHI RIMA SA SE MAI ODIHNEASCA TASTEAZA "');TEXTCOLOR(11);WRITE('N');TEXTCOLOR(RED);
WRITE('".');WRITELN('');
WRITE('                 INSA DACA VREI SA O MAI FUGARESTI UN PIC TASEAZA "');TEXTCOLOR(11);WRITE('Y');
TEXTCOLOR(RED);WRITE('"!');
writeln(' '); writeln(' ');
c:=readkey; if (c='y')or(c='Y')or(ord(c)=13) then begin close(f1); goto 1; end;
clrscr;
WRITELN(' '); WRITELN(' ');WRITELN(' ');WRITELN(' ');WRITELN(' ');WRITELN(' ');WRITELN(' ');
WRITELN(' ');WRITELN(' ');WRITELN(' ');
TEXTCOLOR(WHITE+YELLOW+1);
writeln('                                    GOODBYE!');
close(f1);
FOR I:=1 TO 3 DO DELAY(poc);
CLRSCR;
if tii then close(f2);
end.
